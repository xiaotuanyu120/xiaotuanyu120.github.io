<!DOCTYPE html>
<html lang="zh-cmn">

<head>
    <title>XTY Blog | Linux Ops Docs | SRE | DEVOPS</title>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <link rel="stylesheet" href="/static/css/chroma.css">
    <link rel="stylesheet" href="/static/css/main.css">
</head>

<div class="blog-title">
	<div class="container">
		<div class="row">
			<div class="col-lg-12">
				<div>
					<a class="main-title" href="/">XTY的小站</a>
                </div>
                <div>
                    <a class="small-title" href="/">记录技术笔记和技术博客</a>
                </div>
			</div>
		</div>
	</div>
</div>

<body>
  <div class="container">

    <div class="col-lg-4 col-lg-offset-1 col-md-4 col-md-offset-1 col-sm-4 col-sm-offset-1">
	  <div id="sidebar">

		<h3>最新文章</h3>
          <ul>

            <li>
              <a href="/leetcode/binary_tree/easy_94_binary_tree_inorder_traversal.html">94. Binary Tree Inorder Traversal</a>
            </li>
            <li>
              <a href="/leetcode/binary_tree/binary_tree.html">Binary Tree</a>
            </li>
            <li>
              <a href="/leetcode/linked_list/easy_21_merge_two_sorted_list.html">21. Merge Two Sorted List</a>
            </li>
            <li>
              <a href="/leetcode/linked_list/easy_206_reverse_linked_list.html">206. Reverse Linked List</a>
            </li>
            <li>
              <a href="/leetcode/linked_list/easy_141_linked_list_cycle.html">141. Linked List Cycle</a>
            </li>
          </ul>

		<h3>文章分类</h3>
		  <ul>

            <li>
              <a href="/android/index.html">android</a>
            </li>
            <li>
              <a href="/bigdata/index.html">bigdata</a>
            </li>
            <li>
              <a href="/blockchain/index.html">blockchain</a>
            </li>
            <li>
              <a href="/blog/index.html">blog</a>
            </li>
            <li>
              <a href="/cloud/index.html">cloud</a>
            </li>
            <li>
              <a href="/leetcode/index.html">leetcode</a>
            </li>
            <li>
              <a href="/cryptography/index.html">cryptography</a>
            </li>
            <li>
              <a href="/database/index.html">database</a>
            </li>
            <li>
              <a href="/devops/index.html">devops</a>
            </li>
            <li>
              <a href="/go/index.html">go</a>
              <ul>
                <li>
                  <a href="/go/go/index.html">go</a>
                  <ul>
                    <li><a href="/go/go/go_1.0.0_introduction.html">GO 1.0.0 go语言</a></li>
                    <li><a href="/go/go/go_1.1.0_install.html">GO 1.1.0 安装</a></li>
                    <li><a href="/go/go/go_1.1.1_code_struct.html">GO 1.1.1 程序结构和编译</a></li>
                    <li><a href="/go/go/go_1.1.2_proj_struct.html">GO 1.1.2 目录结构</a></li>
                    <li><a href="/go/go/go_1.1.3_build.html">GO 1.1.3 构建应用</a></li>
                    <li><a href="/go/go/go_1.1.4_start_init.html">GO 1.1.4 入口函数和包初始化</a></li>
                    <li><a href="/go/go/go_1.2.0_gb.html">GO 1.2.0 build tools-gb</a></li>
                    <li><a href="/go/go/go_1.3.0_tools.html">GO 1.3.0 原生工具</a></li>
                    <li><a href="/go/go/go_1.4.0_error_Scan_for_time.Time.html">GO 1.4.0 error Scan() 支持time.Time</a></li>
                    <li><a href="/go/go/go_1.4.1_error_ld_cannot_find_lstdc++.html">GO 1.4.1 error 编译错误 - ld: cannot find -lstdc++</a></li>
                    <li><a href="/go/go/go_1.5.0_iterate_field_of_struct.html">GO 1.5.0 遍历struct的fields</a></li>
                    <li><a href="/go/go/go_1.6.0_reflect_get_struct_tag_name.html">GO 1.6.0 reflect获取struct的tag值</a></li>
                    <li><a href="/go/go/go_1.7.0_string_to_byte.html">GO 1.7.0 string转换成byte</a></li>
                    <li><a href="/go/go/go_2.1.0_slice_append_extend.html">GO 2.1.0 slice append元素和extend新slice</a></li>
                    <li><a href="/go/go/go_2.2.0_typeof_object.html">GO 2.2.0 查看object的type的三种方法</a></li>
                  </ul>
                </li>
                <li>
                  <a href="/go/prog_mode/index.html">prog_mode</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="/ios/index.html">ios</a>
            </li>
            <li>
              <a href="/java/index.html">java</a>
            </li>
            <li>
              <a href="/linux/index.html">linux</a>
            </li>
            <li>
              <a href="/python/index.html">python</a>
            </li>
            <li>
              <a href="/service/index.html">service</a>
            </li>
            <li>
              <a href="/virtualization/index.html">virtualization</a>
            </li>
            <li>
              <a href="/web/index.html">web</a>
            </li>
          </ul>

      </div>
    </div>

    <div class="col-lg-7 col-md-7 col-sm-7">
      <h2>GO 1.1.2 目录结构</h2>
      <div>
        <hr style="border: 0; border-top: 1px dashed #a2a9b6">
      </div>
      <div class="postDate">
        <p>25 Oct 2022</p>
      </div>
      <div>
        <hr style="border: 0; border-bottom: 1px dashed #a2a9b6">
      </div>
<h2>1. 几次目录结构的演进</h2>

<h3>1.1 Go 1.4 版本中，移除 pkg 和引入 internal</h3>

<p>Go 1.4 版本中删除了 pkg 这一中间层目录，并引入了 internal 目录。</p>

<p>出于简化层次的目的，原本<code>src/pkg/xxx</code>改为<code>src/xxx</code>。</p>

<p>出于分类和清晰用途的目的，引入了 internal 目录，在 internal 下的包只能被本项目的包导入，而不能被外部的包导入。</p>

<h3>1.2 Go 1.6 版本中，增加 vendor 目录</h3>

<p>为了解决版本依赖问题，Go 允许源码不在 GOPATH 中寻找依赖包，而是在 vendor 目录下面寻找依赖包。这样开发者就可以在 vendor 中自己管理依赖包的版本，从而解决不同开发环境依赖包版本不一致的问题。</p>

<p>vendor 机制和目录的引入，让 Go 第一次拥有了可重现构建的能力</p>

<h3>1.3 Go 1.13 版本中，增加了 go.sum 和 go.mod</h3>

<p>依旧是为了解决版本依赖的问题，vendor 机制有很多缺点，例如，需要手工管理依赖包版本，另外会给代码审核带来干扰等。于是 go module 出现了，引入了 go.mod 来明确了第三方包及其版本，可以实现精准构建。</p>

<h2>2. 典型结构布局</h2>
<pre class="chroma">- exe-layout
  - cmd/
    - app1/
      - main.go
    - app2/
      - main.go
  - go.mod
  - go.sum
  - internal
    - pkga/
      - pkga.go
    - pkgb/
      - pkgb.go
  - pkg1/
    - pkg1.go
  - pkg2/
    - pkg2.go 
  - vendor/
</pre>
<blockquote>
<p>vendor 目录是可选的，在某些没有公网访问的场景可用，使用vendor模式构建：<code>go build -mod=vendor</code></p>

<p>Go 1.14 版本及其后续版本，当项目根目录存在 vendor 目录时，默认采用 vendor 模式来构建应用。可以使用 <code>go build -mod=mod</code> 来切换到 Go Module 模式。详细说明参见<a href="https://go.dev/doc/go1.14">Go 1.14 changelog</a></p>
</blockquote>

<p>上面提到的例子有多个app构建，其实更建议使用下面app互相隔离的方式</p>
<pre class="chroma">- single-exe-layout
  - main.go
  - go.mod
  - go.sum
  - internal
    - pkga/
      - pkga.go
    - pkgb/
      - pkgb.go
  - pkg1/
    - pkg1.go
  - pkg2/
    - pkg2.go 
  - vendor/
</pre>
<p><strong>总结：虽然上面有提到了多种目录结构，但是 Go 官方并没有给出一个固定的目录结构范式。而且目前主流的开源项目的目录结构也都有着些许的差别，所以并不需要完全一对一的参照本文的模板来创建项目。</strong></p>

    </div>

  </div>
</body>

<footer>
    <div class="container">
        <div class="row footer-links">
            <div class="col-lg-2 col-sm-2">
                <h3>友情链接</h3>
                <ul>
                    <li><a href="">友链位招租</a></li>
                    <li><a href="">友链位招租</a></li>
                </ul>
            </div>
            <div class="col-lg-2 col-sm-2">
                <h3>没想好</h3>
                <ul>
                    <li><a href="">我爸没想好</a></li>
                    <li><a href="">我哥说我爸没想好</a></li>
                </ul>
            </div>
            <div class="col-lg-2 col-sm-2">
                <h3>Hooray</h3>
                <ul>
                    <li><a href="">Hooray</a></li>
                    <li><a href="">What are we Hooray For?</a></li>
                </ul>
            </div>
            <div class="col-lg-2 col-sm-2">
                <h3>前面的footer太浪了</h3>
                <ul>
                    <li><a href="">就是就是</a></li>
                    <li><a href="">偷偷的表示羡慕</a></li>
                </ul>
            </div>
            <div class="col-lg-4 col-sm-4">
                <h3>网站信息</h3>
                <a class="" href="" target="_blank"></a>
                <a class="" href="" target="_blank"></a>
                <a class="" href="" target="_blank"></a>
                <a class="" href="" target="_blank"></a>
                <div class="fine-print">
                    <p>网战由以下技术支撑</p>
                    <ul>
                        <li>Markdown Processor: <a href="https://github.com/russross/blackfriday/tree/v2">Blackfriday V2</a></li>
                        <li>Renderer Engine: <a href="https://github.com/Depado/bfchroma/">bfchroma</a></li>
                        <li>Syntax Highlighter: <a href="https://github.com/alecthomas/chroma">Chroma</a></li>
                        <li>Coding Language: <a href="https://go.dev/">Golang</a></li>
                        <li>Others: Markdown, HTML, CSS</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</footer>

</html>