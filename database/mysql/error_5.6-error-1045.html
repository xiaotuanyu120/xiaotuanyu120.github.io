<!DOCTYPE html>
<html lang="zh-cmn">

<head>
    <title>XTY Blog | Linux Ops Docs | SRE | DEVOPS</title>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <link rel="stylesheet" href="/static/css/chroma.css">
    <link rel="stylesheet" href="/static/css/main.css">
</head>

<div class="blog-title">
	<div class="container">
		<div class="row">
			<div class="col-lg-12">
				<div>
					<a class="main-title" href="/">XTY的小站</a>
                </div>
                <div>
                    <a class="small-title" href="/">记录技术笔记和技术博客</a>
                </div>
			</div>
		</div>
	</div>
</div>

<body>
  <div class="container">

    <div class="col-lg-4 col-lg-offset-1 col-md-4 col-md-offset-1 col-sm-4 col-sm-offset-1">
	  <div id="sidebar">

		<h3>最新文章</h3>
          <ul>

            <li>
              <a href="/linux/advance/memory_03_general_memory_layout.html">内存: 进程内存布局 - 堆栈</a>
            </li>
            <li>
              <a href="/service/nginx/nginx_2.1.9.03_configuration_log.html">nginx: 配置 - 日志</a>
            </li>
            <li>
              <a href="/linux/advance/network_tunnel-ipip.html">网络: 隧道 - IPIP</a>
            </li>
            <li>
              <a href="/linux/advance/network_ip-address.html">网络: IP - IP地址简介</a>
            </li>
            <li>
              <a href="/linux/advance/bash_02_00_login_shell_vs_non_login_shell.html">bash: login shell vs non-login shell</a>
            </li>
          </ul>

		<h3>文章分类</h3>
		  <ul>

            <li>
              <a href="/android/index.html">android</a>
            </li>
            <li>
              <a href="/bigdata/index.html">bigdata</a>
            </li>
            <li>
              <a href="/blockchain/index.html">blockchain</a>
            </li>
            <li>
              <a href="/blog/index.html">blog</a>
            </li>
            <li>
              <a href="/cloud/index.html">cloud</a>
            </li>
            <li>
              <a href="/cryptography/index.html">cryptography</a>
            </li>
            <li>
              <a href="/database/index.html">database</a>
              <ul>
                <li>
                  <a href="/database/mysql/index.html">mysql</a>
                  <ul>
                    <li><a href="/database/mysql/MYSQL_多实例配置+启动脚本.html">MYSQL: 多实例配置+启动脚本</a></li>
                    <li><a href="/database/mysql/MYSQL_无法通过sock登陆.html">MYSQL-error: 无法通过sock登陆</a></li>
                    <li><a href="/database/mysql/MYSQL_查看表ENGINE(v5.6).html">MYSQL: 查看表ENGINE(v5.6)</a></li>
                    <li><a href="/database/mysql/MYSQL_设置wait_timeout控制sleep线程太多.html">MYSQL: 设置wait_timeout控制sleep线程太多</a></li>
                    <li><a href="/database/mysql/MySQL_增量备份-binlog.html">MySQL: 增量备份-binlog</a></li>
                    <li><a href="/database/mysql/MySQL_备份及恢复理论.html">MySQL:备份及恢复理论</a></li>
                    <li><a href="/database/mysql/MySQL_安装脚本.html">MySQL: 安装脚本</a></li>
                    <li><a href="/database/mysql/MySQL_配置及优化.html">MySQL: 配置及优化</a></li>
                    <li><a href="/database/mysql/error_1.0_force_close_of_thread.html">MYSQL-错误: 1.0 force close of thread xxx user: 'someuser'</a></li>
                    <li><a href="/database/mysql/error_1.1_cant_connect_mysql_remotely.html">MYSQL-错误: 1.1 DNS查询优化和Host缓存</a></li>
                    <li><a href="/database/mysql/error_5.6-error-1045.html">error: 5.6-error-1045</a></li>
                    <li><a href="/database/mysql/error_innodb_init.html">MYSQL-错误：无法启动排障</a></li>
                    <li><a href="/database/mysql/error_主从_1062Duplicateentry_.html">error: 主从"1062 Duplicate entry"</a></li>
                    <li><a href="/database/mysql/error_双主错误1593.html">error: 双主错误1593</a></li>
                    <li><a href="/database/mysql/error_服务无法启动报错.html">error: 服务无法启动报错</a></li>
                    <li><a href="/database/mysql/error_表只读.html">error: 表只读</a></li>
                    <li><a href="/database/mysql/mysql_1.0.0_installation.html">mysql 1.0.0: 安装教程</a></li>
                    <li><a href="/database/mysql/mysql_1.0.1_docker_compose.html">mysql 1.0.1: docker-compose(单实例和主从)</a></li>
                    <li><a href="/database/mysql/mysql_3.0.0_basic_operation.html">mysql 3.0.0：常用命令</a></li>
                    <li><a href="/database/mysql/mysql_4.0.1_problem_caused_by_auto_increment.html">mysql 4.0.1：auto_increment引起的问题</a></li>
                    <li><a href="/database/mysql/mysql_config_basic.html">MySQL: 配置 - 常用基本配置</a></li>
                    <li><a href="/database/mysql/mysql_config_optimize.html">MySQL: 配置 - 调优</a></li>
                    <li><a href="/database/mysql/mysql_config_set_character_collation.html">MySQL: 配置 - 配置字符集为utf8</a></li>
                    <li><a href="/database/mysql/mysql_error_start_login.html">MYSQL-错误：启动/登录报错</a></li>
                    <li><a href="/database/mysql/mysql_ha-mycat-00-introduction.html">MySQL: HA - mycat简介</a></li>
                    <li><a href="/database/mysql/mysql_ha-mycat-01-installation-and-write-read-seperate.html">MySQL: HA - mycat安装&读写分离</a></li>
                    <li><a href="/database/mysql/mysql_manage_backup_recovery.html">MySQL: 管理 - 备份及恢复</a></li>
                    <li><a href="/database/mysql/mysql_manage_reset_root_password.html">MySQL: 管理 - 忘记root密码</a></li>
                    <li><a href="/database/mysql/mysql_replica-master-and-master-v5.5.html">MySQL: 复制 - 双主配置(MySQL5.5)</a></li>
                    <li><a href="/database/mysql/mysql_replica-master-and-slave-v5.6-centos6.html">MySQL: 复制 - 主从配置(MySQL5.6 on centos6)</a></li>
                  </ul>
                </li>
                <li>
                  <a href="/database/oracle/index.html">oracle</a>
                </li>
                <li>
                  <a href="/database/rabbitmq/index.html">rabbitmq</a>
                </li>
                <li>
                  <a href="/database/redis/index.html">redis</a>
                </li>
                <li>
                  <a href="/database/rocketmq/index.html">rocketmq</a>
                </li>
                <li>
                  <a href="/database/sql/index.html">sql</a>
                </li>
                <li>
                  <a href="/database/zookeeper/index.html">zookeeper</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="/devops/index.html">devops</a>
            </li>
            <li>
              <a href="/go/index.html">go</a>
            </li>
            <li>
              <a href="/ios/index.html">ios</a>
            </li>
            <li>
              <a href="/java/index.html">java</a>
            </li>
            <li>
              <a href="/linux/index.html">linux</a>
            </li>
            <li>
              <a href="/python/index.html">python</a>
            </li>
            <li>
              <a href="/service/index.html">service</a>
            </li>
            <li>
              <a href="/virtualization/index.html">virtualization</a>
            </li>
            <li>
              <a href="/web/index.html">web</a>
            </li>
          </ul>

      </div>
    </div>

    <div class="col-lg-7 col-md-7 col-sm-7">
      <h2>error: 5.6-error-1045</h2>
      <div>
        <hr style="border: 0; border-top: 1px dashed #a2a9b6">
      </div>
      <div class="postDate">
        <p>21 Apr 2016</p>
      </div>
      <div>
        <hr style="border: 0; border-bottom: 1px dashed #a2a9b6">
      </div>
<h3>1.1 root登录时发现1045错误</h3>
<pre class="chroma"># mysql -u root -p -hlocalhost
Enter password: 
ERROR 1045 (28000): Access denied for user &#39;root&#39;@&#39;localhost&#39; (using password: YES)
</pre>
<h3>1.2 解决办法</h3>
<pre class="chroma">## skip-grant或者用其他有权限的用户登录进去
mysql&gt; update mysql.user set password=password(&#39;dfdH236Fiuk89443gREWGER233OFOIJ&#39;) where user=&#39;root&#39;;
Query OK, 3 rows affected (0.00 sec)
Rows matched: 3  Changed: 3  Warnings: 0
 
mysql&gt; flush privileges;
Query OK, 0 rows affected (0.00 sec)
</pre>
<h3>2.1 root创建用户时1045错误</h3>
<pre class="chroma">mysql&gt; select current_user();
+----------------+
| current_user() |
+----------------+
| admin@%        |
+----------------+
1 row in set (0.00 sec)
 
mysql&gt; show grants for &#39;admin&#39;@&#39;%&#39;\G
*************************** 1. row ***************************
Grants for admin@%: GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, RELOAD, SHUTDOWN, PROCESS, REFERENCES, INDEX, ALTER, SHOW DATABASES, SUPER, CREATE TEMPORARY TABLES, LOCK TABLES, EXECUTE, REPLICATION SLAVE, REPLICATION CLIENT, CREATE VIEW, SHOW VIEW, CREATE ROUTINE, ALTER ROUTINE, CREATE USER, EVENT, TRIGGER ON *.* TO &#39;admin&#39;@&#39;%&#39; IDENTIFIED BY PASSWORD &#39;*DC272C03782058C9313AC508B08CFE94882C5CAD&#39; WITH GRANT OPTION
1 row in set (0.00 sec)
 
mysql&gt; select user,host from mysql.user;
+----------------+-----------------------+
| user           | host                  |
+----------------+-----------------------+
| admin          | %                     |
| mysql_web_user | 127.0.0.1             |
| root           | 127.0.0.1             |
| mysql_web_user | localhost             |
| root           | localhost             |
| test           | localhost             |
| root           | localhost.localdomain |
+----------------+-----------------------+
7 rows in set (0.00 sec)
 
## 无法grant所有表的所有权限
mysql&gt; grant all privileges on *.* to &#39;test&#39;@&#39;localhost&#39;;
ERROR 1045 (28000): Access denied for user &#39;admin&#39;@&#39;%&#39; (using password: YES)
 
## 但可以grant部分表的权限
mysql&gt; grant all privileges on some_db.* to &#39;test&#39;@&#39;localhost&#39;;
Query OK, 0 rows affected (0.00 sec)
## 网上有人说这是因为admin本身没有all privileges所以无法授权*.*
</pre>
<h3>2.2 解决办法</h3>
<pre class="chroma">mysql&gt; grant all privileges on `%`.* to &#39;test&#39;@&#39;localhost&#39;;
Query OK, 0 rows affected (0.00 sec)
</pre>
    </div>

  </div>
</body>

<footer>
    <div class="container">
        <div class="row footer-links">
            <div class="col-lg-2 col-sm-2">
                <h3>友情链接</h3>
                <ul>
                    <li><a href="">友链位招租</a></li>
                    <li><a href="">友链位招租</a></li>
                </ul>
            </div>
            <div class="col-lg-2 col-sm-2">
                <h3>没想好</h3>
                <ul>
                    <li><a href="">我爸没想好</a></li>
                    <li><a href="">我哥说我爸没想好</a></li>
                </ul>
            </div>
            <div class="col-lg-2 col-sm-2">
                <h3>Hooray</h3>
                <ul>
                    <li><a href="">Hooray</a></li>
                    <li><a href="">What are we Hooray For?</a></li>
                </ul>
            </div>
            <div class="col-lg-2 col-sm-2">
                <h3>前面的footer太浪了</h3>
                <ul>
                    <li><a href="">就是就是</a></li>
                    <li><a href="">偷偷的表示羡慕</a></li>
                </ul>
            </div>
            <div class="col-lg-4 col-sm-4">
                <h3>网站信息</h3>
                <a class="" href="" target="_blank"></a>
                <a class="" href="" target="_blank"></a>
                <a class="" href="" target="_blank"></a>
                <a class="" href="" target="_blank"></a>
                <div class="fine-print">
                    <p>网战由以下技术支撑</p>
                    <ul>
                        <li>Markdown Processor: <a href="https://github.com/russross/blackfriday/tree/v2">Blackfriday V2</a></li>
                        <li>Renderer Engine: <a href="https://github.com/Depado/bfchroma/">bfchroma</a></li>
                        <li>Syntax Highlighter: <a href="https://github.com/alecthomas/chroma">Chroma</a></li>
                        <li>Coding Language: <a href="https://go.dev/">Golang</a></li>
                        <li>Others: Markdown, HTML, CSS</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</footer>

</html>