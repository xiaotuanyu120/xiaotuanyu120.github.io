<!DOCTYPE html>
<html lang="zh-cmn">

<head>
    <title>XTY Blog | Linux Ops Docs | SRE | DEVOPS</title>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <link rel="stylesheet" href="/static/css/chroma.css">
    <link rel="stylesheet" href="/static/css/main.css">
</head>

<div class="blog-title">
	<div class="container">
		<div class="row">
			<div class="col-lg-12">
				<div>
					<a class="main-title" href="/">XTY的小站</a>
                </div>
                <div>
                    <a class="small-title" href="/">记录技术笔记和技术博客</a>
                </div>
			</div>
		</div>
	</div>
</div>

<body>
  <div class="container">

    <div class="col-lg-4 col-lg-offset-1 col-md-4 col-md-offset-1 col-sm-4 col-sm-offset-1">
	  <div id="sidebar">

		<h3>最新文章</h3>
          <ul>

            <li>
              <a href="/go/go/go_1.1.3_build.html">GO 1.1.3 构建应用</a>
            </li>
            <li>
              <a href="/go/go/go_1.1.2_proj_struct.html">GO 1.1.2 目录结构</a>
            </li>
            <li>
              <a href="/go/go/go_1.1.1_code_struct.html">GO 1.1.1 程序结构和编译</a>
            </li>
            <li>
              <a href="/go/go/go_1.0.0_introduction.html">GO 1.0.0 go语言</a>
            </li>
            <li>
              <a href="/service/tomcat/tomcat_1.0.0_what_is_jakarta_ee_and_tomcat.html">tomcat 1.0.0 Jakarta EE 和 Tomcat</a>
            </li>
          </ul>

		<h3>文章分类</h3>
		  <ul>

            <li>
              <a href="/android/index.html">android</a>
            </li>
            <li>
              <a href="/bigdata/index.html">bigdata</a>
            </li>
            <li>
              <a href="/blockchain/index.html">blockchain</a>
            </li>
            <li>
              <a href="/blog/index.html">blog</a>
            </li>
            <li>
              <a href="/cloud/index.html">cloud</a>
            </li>
            <li>
              <a href="/cryptography/index.html">cryptography</a>
            </li>
            <li>
              <a href="/database/index.html">database</a>
              <ul>
                <li>
                  <a href="/database/mysql/index.html">mysql</a>
                </li>
                <li>
                  <a href="/database/oracle/index.html">oracle</a>
                  <ul>
                    <li><a href="/database/oracle/1.0.0_silent_installation_env.html">1.0.0 silent模式安装oracle 11G R2 之 环境准备</a></li>
                    <li><a href="/database/oracle/1.1.0_silent_installation_oracle_install.html">1.1.0 silent模式安装oracle 11G R2 之 oracle程序安装</a></li>
                    <li><a href="/database/oracle/1.2.0_silent_installation_netca_listen.html">1.2.0 silent模式安装oracle 11G R2 之 netca监听</a></li>
                    <li><a href="/database/oracle/1.3.0_silent_installation_dbca_dbinstance.html">1.3.0 silent模式安装oracle 11G R2 之 安装database实例</a></li>
                    <li><a href="/database/oracle/1.4.0_silent_installation_error.html">1.4.0 silent模式安装oracle 11G R2 之 安装错误</a></li>
                    <li><a href="/database/oracle/1.5.0_silent_install_about_cvuqdisk.html">1.5.0 silent安装之cvuqdisk</a></li>
                    <li><a href="/database/oracle/1.6.0_OUI_installation_error.html">1.6.0 OUI安装oracle 11G R2 之 oracle程序安装错误集合</a></li>
                    <li><a href="/database/oracle/2.1.0_oracle_sql_statement.html">2.1.0 oracle sql语句之表备份实例</a></li>
                    <li><a href="/database/oracle/2.2.0_oracle_sql_drop_database.html">2.2.0 oracle sql语句之删除数据库</a></li>
                    <li><a href="/database/oracle/3.1.0_rac_oracle_11g_r2_architechture.html">3.1.0 RAC-架构预览</a></li>
                    <li><a href="/database/oracle/3.10.0_rac_dbca_create_database.html">3.10.0 RAC-通过DBCA创建数据库</a></li>
                    <li><a href="/database/oracle/3.11.0_rac_management.html">3.11.0 RAC-管理命令</a></li>
                    <li><a href="/database/oracle/3.2.0_rac_oracle_11g_r2_config_hostname_network.html">3.2.0 RAC-配置主机名和网络</a></li>
                    <li><a href="/database/oracle/3.3.0_rac_oracle_11g_r2_config_ntp.html">3.3.0 RAC-配置ntp服务</a></li>
                    <li><a href="/database/oracle/3.4.0_rac_oracle_11g_r2_config_os.html">3.4.0 RAC-系统配置</a></li>
                    <li><a href="/database/oracle/3.5.0_rac_oracle_11g_r2_config_user_group.html">3.5.0 RAC-配置用户和组</a></li>
                    <li><a href="/database/oracle/3.6.0_rac_oracle_11g_r2_config_storage.html">3.6.0 RAC-存储配置</a></li>
                    <li><a href="/database/oracle/3.7.0_rac_oracle_11g_r2_install_oracle_grid_infrastructure.html">3.7.0 RAC-安装oracle grid infrastructure</a></li>
                    <li><a href="/database/oracle/3.8.0_rac_oracle_11g_r2_install_oracle_11g_r2_software.html">3.8.0 RAC-安装oracle 11g r2软件</a></li>
                    <li><a href="/database/oracle/3.9.0_rac_asmca_asm_diskgroups.html">3.9.0 RAC-通过ASMCA创建ASM硬盘组</a></li>
                    <li><a href="/database/oracle/4.1.0_oracle_error_ORA-01034.html">4.1.0 oracle error之ORA-01034</a></li>
                    <li><a href="/database/oracle/4.2.0_oracle_error_display.html">4.2.0 oracle error之图形安装DISPLAY错误</a></li>
                    <li><a href="/database/oracle/5.1.0_dataguard_oracle_11gr2_installation.html">5.1.0 oracle dataguard 11g r2 搭建</a></li>
                    <li><a href="/database/oracle/5.1.1_dataguard_oracle_11gr2_error.html">5.1.1 oracle dataguard 11g r2 rman恢复错误</a></li>
                    <li><a href="/database/oracle/5.2.0_dataguard_oracle_11gr2_multi_stby_installation.html">5.2.0 oracle dataguard 11g r2 一主多备搭建</a></li>
                    <li><a href="/database/oracle/5.3.0_dataguard_oracle_11gr2_manage.html">5.3.0 oracle dataguard 11g r2 管理命令</a></li>
                    <li><a href="/database/oracle/6.1.0_error_ora_28001_password_expired.html">6.2.0 ora-28001 the password has expired</a></li>
                  </ul>
                </li>
                <li>
                  <a href="/database/rabbitmq/index.html">rabbitmq</a>
                </li>
                <li>
                  <a href="/database/redis/index.html">redis</a>
                </li>
                <li>
                  <a href="/database/rocketmq/index.html">rocketmq</a>
                </li>
                <li>
                  <a href="/database/sql/index.html">sql</a>
                </li>
                <li>
                  <a href="/database/zookeeper/index.html">zookeeper</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="/devops/index.html">devops</a>
            </li>
            <li>
              <a href="/go/index.html">go</a>
            </li>
            <li>
              <a href="/ios/index.html">ios</a>
            </li>
            <li>
              <a href="/java/index.html">java</a>
            </li>
            <li>
              <a href="/linux/index.html">linux</a>
            </li>
            <li>
              <a href="/python/index.html">python</a>
            </li>
            <li>
              <a href="/service/index.html">service</a>
            </li>
            <li>
              <a href="/virtualization/index.html">virtualization</a>
            </li>
            <li>
              <a href="/web/index.html">web</a>
            </li>
          </ul>

      </div>
    </div>

    <div class="col-lg-7 col-md-7 col-sm-7">
      <h2>3.1.0 RAC-架构预览</h2>
      <div>
        <hr style="border: 0; border-top: 1px dashed #a2a9b6">
      </div>
      <div class="postDate">
        <p>22 Dec 2016</p>
      </div>
      <div>
        <hr style="border: 0; border-bottom: 1px dashed #a2a9b6">
      </div>
<h3>0. redhat doc link</h3>

<p><a href="https://access.redhat.com/sites/default/files/attachments/deploying-oracle-11gr2-rac-on-rhel6_1.1.pdf">redhat rac installation manual</a></p>

<hr />

<h3>1. RAC-architechture overview</h3>

<h4>1) 总体架构图片</h4>

<p><img src="/static/images/docs/database/oralce/database-oracle-3.1.0-01.PNG" alt="" /></p>

<h4>2) 网络</h4>

<p><img src="/static/images/docs/database/oralce/database-oracle-3.1.0-02.PNG" alt="" /></p>

<ul>
<li>switch*4

<ul>
<li>public 2个公网</li>
<li>private 2个私网</li>
</ul></li>
</ul>

<blockquote>
<p>公网的switch做了链路聚合，使其在逻辑上成为一个switch。而em1和em2则bond在一起成为bond0，提供公网的连接高可用。</p>

<p>私网的em3和em4分别接入private switchA和switchB，得益于oracle的HAIP(Highly Available Internet Protocol)技术，em3和em4不需要做bond，HAIP可提供多达4个nic的负载均衡</p>
</blockquote>

<h4>3) 硬件需求</h4>

<p>推荐配置</p>

<ul>
<li>集群节点

<ul>
<li>至少2G内存</li>
<li>4个网卡</li>
<li>支持1024x768的显示分辨率，用以支持显示OUI的图形界面</li>
<li>集群内所有节点使用统一芯片架构(x86_64)</li>
<li>fiber HBA</li>
</ul></li>
<li>交换机

<ul>
<li>光纤接口</li>
<li>千兆连接</li>
</ul></li>
<li>存储设备</li>
</ul>

<h4>4) 文件系统分区</h4>

<p>软件的最小空间</p>

<table>
<thead>
<tr>
<th>Software</th>
<th>Disk Space</th>
</tr>
</thead>

<tbody>
<tr>
<td>Oracle Grid Infrastructure Home</td>
<td>5.5 GB</td>
</tr>

<tr>
<td>Oracle Database Home Enterprise Edition (includes software files and data files)</td>
<td>8.9 GB</td>
</tr>

<tr>
<td>/tmp</td>
<td>1 GB</td>
</tr>
</tbody>
</table>
<p>两个节点系统各分区最小空间</p>

<table>
<thead>
<tr>
<th>File System Layout</th>
<th>Disk Space Size</th>
</tr>
</thead>

<tbody>
<tr>
<td>/</td>
<td>15 GB</td>
</tr>

<tr>
<td>/dev/shm</td>
<td>24 GB</td>
</tr>

<tr>
<td>/boot</td>
<td>248 MB</td>
</tr>

<tr>
<td>/home</td>
<td>8 GB</td>
</tr>

<tr>
<td>/tmp</td>
<td>4 GB</td>
</tr>

<tr>
<td>/u01</td>
<td>50 GB</td>
</tr>

<tr>
<td>/usr</td>
<td>5 GB</td>
</tr>

<tr>
<td>/var</td>
<td>8 GB</td>
</tr>
</tbody>
</table>
<p>oracle rac database 11g r2 推荐在Oracle ASM硬盘组中有3个不小于1G的空间去冗余存储Oracle Cluster Registry (OCR) 和 voting disks。OCR管理oracle clusterware和oracle rac database 11g r2的配置信息。voting disks管理节点成员的所有相关信息。<br />
此架构推荐以下最小空间</p>

<table>
<thead>
<tr>
<th>Volume</th>
<th>Volume Size</th>
</tr>
</thead>

<tbody>
<tr>
<td>Oracle Database Volume 1 (db1)</td>
<td>100 GB</td>
</tr>

<tr>
<td>Oracle Database Volume 2 (db2)</td>
<td>100 GB</td>
</tr>

<tr>
<td>Fast Recovery Area (fra)</td>
<td>200 GB</td>
</tr>

<tr>
<td>Oracle Redo Log Volume (redo)</td>
<td>10 GB</td>
</tr>

<tr>
<td>OCR &amp; Voting Disks (ocrvote1)</td>
<td>1 GB</td>
</tr>

<tr>
<td>OCR &amp; Voting Disks (ocrvote2)</td>
<td>1 GB</td>
</tr>

<tr>
<td>OCR &amp; Voting Disks (ocrvote3)</td>
<td>1 GB</td>
</tr>
</tbody>
</table>

<h4>5) 共享存储分区</h4>

<table>
<thead>
<tr>
<th>Virtual Diskgroup Name</th>
<th>Volume Name</th>
<th>Volume Size</th>
<th>RAID Group Type</th>
<th>Harddrive Count</th>
<th>Hot Spares Available</th>
<th>Size of Virtual Disk</th>
</tr>
</thead>

<tbody>
<tr>
<td>vd01</td>
<td>db1</td>
<td>100 GB</td>
<td>Raid 10</td>
<td>8</td>
<td>0</td>
<td>586 GB</td>
</tr>

<tr>
<td>vd02</td>
<td>db2</td>
<td>100 GB</td>
<td>Raid 10</td>
<td>8</td>
<td>0</td>
<td>586 GB</td>
</tr>

<tr>
<td>vd03</td>
<td>fra</td>
<td>200 GB</td>
<td>Raid 5</td>
<td>5</td>
<td>0</td>
<td>586 GB</td>
</tr>

<tr>
<td>vd04</td>
<td>redo</td>
<td>10 GB</td>
<td>Raid 1</td>
<td>2</td>
<td>0</td>
<td>146 GB</td>
</tr>

<tr>
<td>vd04</td>
<td>ocrvote1</td>
<td>1 GB</td>
<td>Raid 1</td>
<td>2</td>
<td>0</td>
<td>146 GB</td>
</tr>

<tr>
<td>vd04</td>
<td>ocrvote2</td>
<td>1 GB</td>
<td>Raid 1</td>
<td>2</td>
<td>0</td>
<td>146 GB</td>
</tr>

<tr>
<td>vd04</td>
<td>ocrvote3</td>
<td>1 GB</td>
<td>Raid 1</td>
<td>2</td>
<td>0</td>
<td>146 GB</td>
</tr>

<tr>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>1</td>
<td>1</td>
<td>146 GB</td>
</tr>
</tbody>
</table>

<h4>6) swap 分区</h4>

<p>swap分区的大小取决于ram的大小</p>

<table>
<thead>
<tr>
<th>RAM</th>
<th>Swap Space</th>
</tr>
</thead>

<tbody>
<tr>
<td>2.5 GB up to 16 GB</td>
<td>Equal to the size of RAM</td>
</tr>

<tr>
<td>Greater than 16 GB</td>
<td>16 GB of RAM</td>
</tr>
</tbody>
</table>

<h4>7) iptables开放端口</h4>

<p>其实可以先关闭，若希望打开，可以开放以下端口</p>

<table>
<thead>
<tr>
<th>Port</th>
<th>Protocol Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>22</td>
<td>TCP Secure Shell (SSH)</td>
</tr>

<tr>
<td>80</td>
<td>TCP Hypertext Transfer Protocol (HTTP)</td>
</tr>

<tr>
<td>443</td>
<td>TCP Hypertext Transfer Protocol over SSL/TLS (HTTPS)</td>
</tr>

<tr>
<td>1521</td>
<td>TCP Oracle Transparent Network Substrate (TNS) Listener default port</td>
</tr>

<tr>
<td>1158</td>
<td>TCP Oracle Enterprise Manager 11g default port</td>
</tr>
</tbody>
</table>

<h4>8) selinux</h4>

<p>推荐关闭</p>

    </div>

  </div>
</body>

<footer>
    <div class="container">
        <div class="row footer-links">
            <div class="col-lg-2 col-sm-2">
                <h3>友情链接</h3>
                <ul>
                    <li><a href="">友链位招租</a></li>
                    <li><a href="">友链位招租</a></li>
                </ul>
            </div>
            <div class="col-lg-2 col-sm-2">
                <h3>没想好</h3>
                <ul>
                    <li><a href="">我爸没想好</a></li>
                    <li><a href="">我哥说我爸没想好</a></li>
                </ul>
            </div>
            <div class="col-lg-2 col-sm-2">
                <h3>Hooray</h3>
                <ul>
                    <li><a href="">Hooray</a></li>
                    <li><a href="">What are we Hooray For?</a></li>
                </ul>
            </div>
            <div class="col-lg-2 col-sm-2">
                <h3>前面的footer太浪了</h3>
                <ul>
                    <li><a href="">就是就是</a></li>
                    <li><a href="">偷偷的表示羡慕</a></li>
                </ul>
            </div>
            <div class="col-lg-4 col-sm-4">
                <h3>网站信息</h3>
                <a class="" href="" target="_blank"></a>
                <a class="" href="" target="_blank"></a>
                <a class="" href="" target="_blank"></a>
                <a class="" href="" target="_blank"></a>
                <div class="fine-print">
                    <p>网战由以下技术支撑</p>
                    <ul>
                        <li>Markdown Processor: <a href="https://github.com/russross/blackfriday/tree/v2">Blackfriday V2</a></li>
                        <li>Renderer Engine: <a href="https://github.com/Depado/bfchroma/">bfchroma</a></li>
                        <li>Syntax Highlighter: <a href="https://github.com/alecthomas/chroma">Chroma</a></li>
                        <li>Coding Language: <a href="https://go.dev/">Golang</a></li>
                        <li>Others: Markdown, HTML, CSS</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</footer>

</html>